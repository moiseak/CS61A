
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS 61A: Structure and Interpretation of Computer Programs" />
    <meta name="keywords" content ="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS" />
    <meta name="author" content ="Laryn Qi, Charlotte Le, Raymond Tan" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-throttle-debounce/1.1/jquery.ba-throttle-debounce.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../../assets/js/hl.js"></script>
    <script src="../../assets/js/toggledarkmode.js"></script>
    <script>
        // we aren't registering builtins since
        //      (1) they don't render differently in the current CSS from other names
        //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
        // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
        hljsRegister({
            'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
        });
        hljs.initHighlightingOnLoad();
    </script>
    <script src="../../assets/js/dark-mode.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500|Work+Sans:400,700">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/mono-blue.css">
    <link rel="icon" href="../../assets/images/favicon.ico">

    

<link rel="stylesheet" type="text/css" href="../../assets/css/disc.css">


    <title>
Discussion 10 | CS 61A Summer 2024
</title>
  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container noselect">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../index.html">
            <img style="max-width:60px; margin-top: -20px;" class="logo" src="../../assets/images/logo.png"/>
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../../office-hours.html">Weekly Schedule</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="index.html#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                External Websites
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://oh.cs61a.org/">Office Hours Queue</a></li>
                <li><a href="https://pythontutor.com/cp/composingprograms.html">Python Tutor</a></li>
                <li><a href="https://code.cs61a.org/">Online Code Editor</a></li>
                <li><a href="https://www.composingprograms.com/">Textbook</a></li>
                <li><a href="https://edstem.org/us/courses/59836/discussion/">Ed</a></li>
                <li><a href="https://sections.cs61a.org">Sections Tool</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="index.html#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Forms
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/extensions">Request an Extension</a></li>
                <li><a href="https://go.cs61a.org/regrades">Request a Regrade</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="index.html#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="https://go.cs61a.org/debugging-guide">Debugging Guide</a></li>
                <li><a href="../../articles/studying.html">Studying Guide</a></li>
                <li><a href="../../articles/composition.html">Composition Guide</a></li>
                <li><a href="../../articles/pair-programming.html">Pair Programming Guide</a></li>
                <li><a href="../../resources.html">Past Exams & Websites</a></li>
                <li><a href="../../articles/campus-res/index.html">Department and Campus</a></li>
                <li><a href="../../articles/advice/index.html">Advice from Former Students</a></li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="index.html#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Staff
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a href="../../instructor.html">Instructors</a></li>
                <li><a href="../../staff.html">TAs & Tutors</a></li>
                <li><a href="../../contact/index.html">Contact</a></li>
              </ul>
            </li>
            <li><a href="../../articles/about.html">Syllabus</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="content" class="container">
      
<div class='row'>
  <div class='col-md-9'>
    <header>
      <h1>
        
Discussion 10: Tail Calls, Scheme Data Abstraction

        
        
        <ul class="inline-block list-inline">
          <li><a href="disc10.pdf" class="label label-outline">disc10.pdf</a></li>
        </ul>
        
        
      </h1>
    </header>
    

<!-- <div class="alert storable-login-status"></div> -->


    
<h1 id="tail-calls">Tail Calls</h1>


<p>When writing a recursive procedure, it's possible to write
it in a <strong>tail recursive</strong> way, where all of the recursive calls are tail calls.
A <strong>tail call</strong> occurs when a function calls another function as the last action of the
current frame.</p>

<p>Consider this implementation of <code>factorial</code> that is <em>not</em> tail recursive:</p>

<pre><code class="scheme">(define (factorial n)
  (if (= n 0)
      1
      (* n (factorial (&#x2d; n 1)))))</code></pre>



<p>The recursive call occurs in the last line, but it is not the last expression
evaluated. After calling <code>(factorial (&#x2d; n 1))</code>, the function still needs to
multiply that result with <code>n</code>. The final expression that is evaluated is
a call to the multiplication function, not <code>factorial</code> itself.  Therefore,
the recursive call is <code>not</code> a tail call.</p>

<p>Here's a visualization of the recursive process for computing <code>(factorial 6)</code> :</p>

<pre><code class="scheme">(factorial 6)
(* 6 (factorial 5))
(* 6 (* 5 (factorial 4)))
(* 6 (* 5 (* 4 (factorial 3))))
(* 6 (* 5 (* 4 (* 3 (factorial 2)))))
(* 6 (* 5 (* 4 (* 3 (* 2 (factorial 1))))))
(* 6 (* 5 (* 4 (* 3 (* 2 1)))))
(* 6 (* 5 (* 4 (* 3 2))))
(* 6 (* 5 (* 4 6)))
(* 6 (* 5 24))
(* 6 120)
720</code></pre>



<p>The interpreter first must reach the base case and only then can it begin
to calculate the products in each of the earlier frames.</p>

<p>We can rewrite this function using a helper function that remembers the
temporary product that we have calculated so far in each recursive step.</p>

<pre><code class="scheme">(define (factorial n)
  (define (fact&#x2d;tail n result)
    (if (= n 0)
        result
        (fact&#x2d;tail (&#x2d; n 1) (* n result))))
  (fact&#x2d;tail n 1))</code></pre>



<p><code>fact&#x2d;tail</code> makes a single recursive call to <code>fact&#x2d;tail</code>, and
that recursive call is the last expression to be evaluated, so it is a tail
call. Therefore, <code>fact&#x2d;tail</code> is a tail recursive process.</p>

<p>Here's a visualization of the tail recursive process for computing <code>(factorial 6)</code>:</p>

<pre><code class="scheme">(factorial 6)
(fact&#x2d;tail 6 1)
(fact&#x2d;tail 5 6)
(fact&#x2d;tail 4 30)
(fact&#x2d;tail 3 120)
(fact&#x2d;tail 2 360)
(fact&#x2d;tail 1 720)
(fact&#x2d;tail 0 720)
720</code></pre>



<p>The interpreter needed less steps to come up with the result, and it didn't need
to re-visit the earlier frames to come up with the final product.</p>

<p>In this example, we've utilized a common strategy in implementing tail-recursive procedures which is to pass the result that we're building (e.g. a list, count, sum, product, etc.) as a argument to our procedure that gets changed across recursive calls. By doing this, we do not have to do any computation to build up the result after the recursive call in the current frame, instead any computation is done <em>before</em> the recursive call and the result is passed to the next frame to be modified further. Often, we do not have a parameter in our procedure that can store this result, but in these cases we can define a helper procedure with an extra parameter(s) and recurse on the helper. This is what we did in the <code>factorial</code> procedure above, with <code>fact&#x2d;tail</code> having the extra parameter <code>result</code>.</p>

<div class="page-break"></div>


<h2 id="tail-call-optimization">Tail Call Optimization</h2>


<p>When a recursive procedure is not written in a tail recursive way,
the interpreter must have enough memory to store all of the previous recursive calls.</p>

<p>For example, a call to the <code>(factorial 3)</code> in the non tail-recursive version
must keep the frames for all the numbers from 3 down to the base case,
until it's finally able to calculate the intermediate products and forget those frames:</p>

<p><img class="img-responsive center-block" src="assets/factorial_stack.svg" alt="" width="" height=""></p>

<p>For non tail-recursive procedures, the number of active frames grows proportionally to the number
of recursive calls. That may be fine for small inputs, but imagine calling <code>factorial</code>
on a large number like 10000. The interpreter would need enough memory for all 1000 calls!</p>

<p>Fortunately, proper Scheme interpreters implement <strong>tail-call optimization</strong>
as a requirement of the language specification. TCO ensures that tail recursive
procedures can execute with a constant number of active frames, so programmers
can call them on large inputs without fear of exceeding the available memory.</p>

<p>When the tail recursive <code>factorial</code> is run in an interpreter with tail-call optimization,
the interpreter knows that it does not need to keep the previous frames around,
so it never needs to store the whole stack of frames in memory:</p>

<p><img class="img-responsive center-block" src="assets/factorial_optimized.svg" alt="" width="" height=""></p>

<p>Tail-call optimization can be implemented in a few ways:</p>

<ol>
  <li>Instead of creating a new frame, the interpreter can just update
  the values of the relevant variables in the current frame (like <code>n</code> and <code>result</code>
  for the <code>fact&#x2d;tail</code> procedure). It reuses the same frame for the
  entire calculation, constantly changing the bindings to match the next set of parameters.</li>
  <li>How our 61A Scheme interpreter works: The interpreter builds a new frame as usual,
  but then <em>replaces</em> the current frame with the new one.  The old frame is still around,
  but the interpreter no longer has any way to get to it.  When that happens, the Python
  interpreter does something clever: it <em>recycles</em> the old frame so that the next time
  a new frame is needed, the system simply allocates it out of recycled space.
  The technical term is that the old frame becomes "garbage", which the system
  "garbage collects" behind the programmer's back.</li>
</ol>

<div class="page-break"></div>


<h2 id="tail-context">Tail Context</h2>


<p>When trying to identify whether a given function call within the body of a
function is a tail call, we look for whether the call expression is in
<strong>tail context</strong>.</p>

<p>Given that each of the following expressions is the last expression in
the body of the function, the following expressions are tail contexts:</p>

<ol>
  <li>the second or third operand in an <code>if</code> expression</li>
  <li>any of the non-predicate sub-expressions in a <code>cond</code> expression
  (i.e. the second expression of each clause)</li>
  <li>the last operand in an <code>and</code> or an <code>or</code> expression</li>
  <li>the last operand in a <code>begin</code> expression's body</li>
  <li>the last operand in a <code>let</code> expression's body</li>
</ol>

<p>For example, in the expression <code>(begin (+ 2 3) (&#x2d; 2 3) (* 2 3))</code>,
<code>(* 2 3)</code> is a tail call because it is the last operand expression to be
evaluated.</p>

<!--\videowalkthrough{tail-recursion-intro}-->

<div class="page-break"></div>


<h3 id="q1-fast-exp">Q1: Fast-Exp</h3>


<p>We can write a faster version of <code>exp</code> , which is a function that raises a number <code>b</code> to the <code>n</code>-th power, that computes its answer much faster
using the method of <em>repeated squaring</em>:</p>

<pre><code class="scheme">    (define (square x) (* x x))

    (define (fast&#x2d;exp&#x2d;recursive b n)
        (cond ((= n 0)
            1)
        ((even? n)
            (square (fast&#x2d;exp&#x2d;recursive b (/ n 2))))
        (else
            (* b (fast&#x2d;exp&#x2d;recursive b (&#x2d; n 1))))))</code></pre>



<p>The previous <code>exp</code> procedure took a linear number of recursive calls,
because it always reduced <code>n</code> by <code>1</code>.  However, <code>fast&#x2d;exp</code> halves the
value of <code>n</code> every two recursive calls at most, and so it takes a
logarithmic number of recursive calls.  <!-- See <a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.4">SICP</a> for more
details. --></p>

<p>However, this new procedure is not tail recursive, and as a result can
use up a lot of memory.  In particular, the following will crash the Scheme interpreter
after a few seconds of computation:</p>

<pre><code class="scheme">(fast&#x2d;exp&#x2d;recursive 1 (&#x2d; (fast&#x2d;exp&#x2d;recursive 2 20000) 1))</code></pre>



<p>Bonus question:  Why did we subtract 1?  In other words, why doesn't
the following crash the interpreter?</p>

<pre><code class="scheme">(fast&#x2d;exp&#x2d;recursive 1 (fast&#x2d;exp&#x2d;recursive 2 20000))</code></pre>



<p>Back to the original question - write <code>fast&#x2d;exp</code> using tail recursion
so that this no longer crashes.  <!-- See <a href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.4">SICP</a>, Exercise 1.16, for a
hint. --></p>


            <div class="monaco-storable" id="fast-exp-input" style="height:306px;"></div>
            <a href="javascript:void" id="modal-link-fast-exp-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-fast-exp-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-fast-exp-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor('(define (fast&#x2d;exp b n)\n        ;; Computes b^n tail recursively by the method of repeated squaring.\n\n    )\n', "scheme", "fast-exp-input"));
            </script>
        

<div class="page-break"></div>


<h3 id="q2-reverse">Q2: Reverse</h3>


<p>Write a tail-recursive function <code>reverse</code> that takes in a Scheme list a
returns a reversed copy. <em>Hint</em>: use a helper function!</p>

<pre><code class="scheme">scm&gt; (reverse &#x27;(1 2 3))
(3 2 1)
scm&gt; (reverse &#x27;(0 9 1 2))
(2 1 9 0)</code></pre>




            <div class="monaco-storable" id="reverse-input" style="height:234px;"></div>
            <a href="javascript:void" id="modal-link-reverse-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-reverse-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-reverse-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (reverse lst)\n  'YOUR-CODE-HERE\n)\n\n(expect (reverse &#x27;(1 2 3)) (3 2 1))\n(expect (reverse &#x27;(0 9 1 2)) (2 1 9 0))\n", "scheme", "reverse-input"));
            </script>
        

<div class="page-break"></div>

<div class="page-break"></div>


<h1 id="scheme-data-abstraction">Scheme Data Abstraction</h1>


<p>Data abstraction is a powerful concept in computer science that
allows programmers to treat code as objects.
For example, using code to represent cars, chairs, people, and so on.
That way, programmers don't have to worry about <em>how</em> code is implemented;
they just have to know <em>what</em> it does.</p>

<p>Data abstraction mimics how we think about the world.
If you want to drive a car, you don't need to know how the
engine was built or what kind of material the tires are made of to do so.
You just have to know how to use the car for driving itself,
such as how to turn the wheel or press the gas pedal.</p>

<p>A data abstraction consists of two types of functions:</p>

<ul>
  <li><strong>Constructors</strong>: functions that build the abstract data type.</li>
  <li><strong>Selectors</strong>: functions that retrieve information from the data type.</li>
</ul>

<p>Programmers design data abstractions to abstract away how information is stored and
calculated such that the end user does <em>not</em> need to know how constructors and
selectors are implemented. The nature of <em>abstraction</em> allows whoever uses them to
assume that the functions have been written correctly and
work as described. Using this idea, developers are able to use a variety of powerful
libraries for tasks such as data processing, security, visualization, and more
without needing to write the code themselves!</p>

<p>In Python, you primarily worked with data abstractions using Object Oriented Programming, which used
Python <code>Object</code>s to store the data. Notably, this is not possible in Scheme, which is a functional
programming language. Instead, we create and return new structures which represent the current state of the data.</p>

<div class="page-break"></div>

<p>Say we have an abstract data type for cities. A city has a name, a latitude
coordinate, and a longitude coordinate.</p>

<p>Our data abstraction has one <strong>constructor</strong>:</p>

<ul>
  <li><code>(make&#x2d;city name lat lon)</code>: Creates a city object with the given name,
  latitude, and longitude.</li>
</ul>

<p>We also have the following <strong>selectors</strong> in order to get the information for
each city:</p>

<ul>
  <li><code>(get&#x2d;name city)</code>: Returns the city's name</li>
  <li><code>(get&#x2d;lat city)</code>: Returns the city's latitude</li>
  <li><code>(get&#x2d;lon city)</code>: Returns the city's longitude</li>
</ul>

<p>Here is how we would use the constructor and selectors to create cities and
extract their information:</p>

<pre><code class="scheme">scm&gt; (define berkeley (make&#x2d;city &#x27;Berkeley 122 37))
berkeley
scm&gt; (get&#x2d;name berkeley)
Berkeley
scm&gt; (get&#x2d;lat berkeley)
122
scm&gt; (define new&#x2d;york (make&#x2d;city &#x27;NYC 74 40))
new&#x2d;york
scm&gt; (get&#x2d;lon new&#x2d;york)
40</code></pre>


<p>The point of data
abstraction is that we do not need to know how an abstract data type is
implemented, but rather just how we can interact with and use the data type.</p>

<div class="page-break"></div>


<h3 id="q3-distance">Q3: Distance</h3>


<p>We will now implement the function <code>distance</code>, which computes the
<em>Euclidean distance</em> between two city objects; the Euclidean distance between two
coordinate pairs <code>(x1, y1)</code> and <code>(x2, y2)</code> can be found by calculating
the <code>sqrt((x1 &#x2d; x2) ** 2 + (y1 &#x2d; y2) ** 2)</code>. Use the latitude and longitude of a city as
its coordinates; you'll need to use the selectors to access this info!</p>

<blockquote><p>You may find the following methods useful:</p>

<ul>
  <li><code>(expt base exp)</code>: calculate <code>base ** exp</code></li>
  <li><code>(sqrt x)</code> calculate <code>sqrt(x)</code></li>
</ul></blockquote>


            <div class="monaco-storable" id="distance-input" style="height:180px;"></div>
            <a href="javascript:void" id="modal-link-distance-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-distance-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-distance-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (distance city&#x2d;a city&#x2d;b)\n    'YOUR-CODE-HERE\n)\n", "scheme", "distance-input"));
            </script>
        


<h3 id="q4-closer-city">Q4: Closer City</h3>


<p>Next, implement <code>closer&#x2d;city</code>, a function that takes a latitude,
longitude, and two cities, and returns the name of the city that is
relatively closer to the provided latitude and longitude.</p>

<p>You may only use the selectors and constructors introduced above and the
<code>distance</code> function you just defined for this question.</p>

<blockquote><p><strong>Hint</strong>: How can you use your <code>distance</code> function to find the distance between
the given location and each of the given cities?</p></blockquote>


            <div class="monaco-storable" id="closer-city-input" style="height:162px;"></div>
            <a href="javascript:void" id="modal-link-closer-city-input">Run in 61A Code</a>
            <div class="modal fade" id="modal-closer-city-input" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content" style="padding-bottom: -5px">
                    <iframe
                        id="code-iframe-closer-city-input"
                        width="100%"
                        height="700px"
                        style="border: none; display:block;"
                    ></iframe>
                    </div>
                </div>
            </div>
            <div class="storable-status"></div>
            <script>
                $(() => activateEditor("(define (closer&#x2d;city lat lon city&#x2d;a city&#x2d;b)\n    'YOUR-CODE-HERE\n)\n", "scheme", "closer-city-input"));
            </script>
        


<h1 id="submit-attendance">Submit Attendance</h1>


<p>You're done! Excellent work this week. Please be sure to ask your section TA for the attendance form link and fill it out for credit. (one submission per person per section).</p>

<!-- **Reminder:** We'll still use Pensieve, but we've removed the voice/video chat from Pensieve. Use Discord for voice chat with the course staff. It's more reliable and includes screensharing. Write to <code>@discuss</code> in the <code>#discuss&#x2d;queue</code> channel on Discord at any time, and a member of the course staff will join your group's voice channel.

Pick someone in your group to <a href="https://cs61a.org/articles/discord">join Discord</a>.
It's fine if multiple people join, but one is enough.

Now switch to Pensieve:

<ul>
  <li><strong>Everyone</strong>: Go to <a href="http://discuss.pensieve.co">discuss.pensieve.co</a> and log in with your @berkeley.edu email, then enter your group number. (Your group number is the number of your Discord channel.)</li>
</ul>

Once you're on Pensieve, you don't need to return to this page; Pensieve has all the same content (but more features). If for some reason Penseive doesn't work, return to this page and continue with the discussion.

Post in the <code>#help</code> channel on <a href="https://cs61a.org/articles/discord/">Discord</a> if you have trouble.

**Pro tip:** Any of you can type a question into your group's Discord <a href="https://support.discord.com/hc/en-us/articles/4412085582359-Text-Channels-Text-Chat-In-Voice-Channels#h_01FMJT412WBX1MR4HDYNR8E95X">channel's text chat</a> with the <code>@discuss</code> tag, and a member of the course staff will respond.

# Getting Started

If you have only 1 or 2 people in your group, you can join the other group in
the room with you.

Everybody say your name, and then figure out who is planning to travel outside
of the Bay Area the soonest.

# Representing Lists

A Scheme call expression is a Scheme list that is represented using a <code>Pair</code>
instance in Python.

For example, the call expression <code>(+ (* 3 4) 5)</code> is represented as:

<pre><code>Pair(&#x27;+&#x27;, Pair(Pair(&#x27;*&#x27;, Pair(3, Pair(4, nil))), Pair(5, nil)))</code></pre>



<img class="img-responsive center-block" src="https://i.imgur.com/I3972ut.png" alt="(+ (* 3 4) 5)" width="" height="">

The <code>Pair</code> class and <code>nil</code> object are defined in <a href="http://cs61a.org/proj/scheme/pair.py">pair.py</a> of the <a href="http://cs61a.org/proj/scheme">Scheme project</a>.

<pre><code>class Pair:
    &quot;A Scheme list is a Pair in which rest is a Pair or nil.&quot;
    def __init__(self, first, rest):
        self.first = first
        self.rest = rest

    ... # There are also __str__, __repr__, and map methods, omitted here.</code></pre>


-->
<!-- <include topics/interpreters/pair_to_exp_2.md> -->

<!--
**Discussion Time:** What does <code>(and (&lt; 1 0) (/ 1 0))</code> evaluate to? Discuss among
your group until you all agree,
then post your answer in your group's Discord
<a href="https://support.discord.com/hc/en-us/articles/4412085582359-Text-Channels-Text-Chat-In-Voice-Channels#h_01FMJT412WBX1MR4HDYNR8E95X">channel's text chat</a>.

# Evaluation

To evaluate the expression <code>(+ (* 3 4) 5)</code> using the Project 4 interpreter,
<code>scheme_eval</code> is called on the following expressions (in this order):

<ol>
  <li><code>(+ (* 3 4) 5)</code></li>
  <li><code>+</code></li>
  <li><code>(* 3 4)</code></li>
  <li><code>*</code></li>
  <li><code>3</code></li>
  <li><code>4</code></li>
  <li><code>5</code></li>
</ol>

**Discussion time:** Describe to each other why <code>*</code> is evaluated and what it
evaluates to.


        <button id='toggle-1' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Answer<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-1">

<p>The <code>*</code> is evaluated because it is the operator sub-expression of <code>(* 3 4)</code>,
which is an operand sub-expression of <code>(+ (* 3 4) 5)</code>.</p>

<p>By default, <code>*</code> evaluates to a procedure that multiplies its arguments together.
But <code>*</code> could be redefined at any time, and so the symbol <code>*</code> must be evaluated
each time it is used in order to look up its current value.</p>

<pre><code>scm&gt; (* 2 3)  ; Now it multiplies
6
scm&gt; (define * +)
*
scm&gt; (* 2 3)  ; Now it adds
5</code></pre>



</div>

<p>An <code>if</code> expression is also a Scheme list represented using a <code>Pair</code> instance.</p>

<p>For example, <code>(if (&lt; x 0) (&#x2d; x) x)</code> is represented as:</p>

<p><code>Pair(&#x27;if&#x27;, Pair(Pair(&#x27;&lt;&#x27;, Pair(&#x27;x&#x27;, Pair(0, nil))), Pair(Pair(&#x27;&#x2d;&#x27;, Pair(&#x27;x&#x27;, nil)), Pair(&#x27;x&#x27;, nil))))</code></p>

<p><img class="img-responsive center-block" src="https://i.imgur.com/JySFkth.png" alt="" width="" height=""></p>

<p>To evaluate this expression in an environment in which <code>x</code> is bound to 2 (and
<code>&lt;</code> and <code>&#x2d;</code> have their default values), <code>scheme_eval</code> is called on the following
expressions (in this order):</p>

<ol>
  <li><code>(if (&lt; x 0) (&#x2d; x) x)</code></li>
  <li><code>(&lt; x 0)</code></li>
  <li><code>&lt;</code></li>
  <li><code>x</code></li>
  <li><code>0</code></li>
  <li><code>x</code></li>
</ol>

<p><strong>Presentation time:</strong> Come up with a short explanation of why neither <code>if</code> nor
<code>&#x2d;</code> are evaluated even though they both appear in <code>(if (&lt; x 0) (&#x2d; x) x)</code>. Once
your group agrees on an answer (or wants help), send a message to the
<code>#discuss&#x2d;queue</code> channel with the <code>@discuss</code> tag, your discussion group number,
and the message "If you please!" and a member of the course staff will join your
voice channel to hear your explanation and give feedback.</p>


-->
<!-- ### Q5: Evaluation -->
<!-- Which of the following are evaluated when <code>scheme_eval</code> is called on
<code>(if (&lt; x 0) (&#x2d; x) (if (= x &#x2d;2) 100 y))</code> in an environment in which <code>x</code> is bound to -2?
(Assume <code>&lt;</code>, <code>&#x2d;</code>, and <code>=</code> have their default values.)

<ul>
  <li><code>if</code></li>
  <li><code>&lt;</code></li>
  <li><code>=</code></li>
  <li><code>x</code></li>
  <li><code>y</code></li>
  <li><code>0</code></li>
  <li><code>&#x2d;2</code></li>
  <li><code>100</code></li>
  <li><code>&#x2d;</code></li>
  <li><code>(</code></li>
  <li><code>)</code>
  --></li>
</ul>

<!--

        <button id='toggle-2' class='btn btn-outline btn-lg alwaystoggle toggle'>
        Hint<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-2">

<p>With <code>x</code> bound to -2, <code>(&lt; x 0)</code> evaluates to <code>#t</code>, and so <code>(&#x2d; x)</code> will be
evaluated, but <code>(if (= x 1) 100 x)</code> will not. The operator and operands of a
call expression are evaluated for every call expression that is evaluated.
<code>(&lt; x 0)</code> and <code>(&#x2d; x)</code> are both call expressions.</p>

</div>

<p>List your group's answers in your group's
Discord <a href="https://support.discord.com/hc/en-us/articles/4412085582359-Text-Channels-Text-Chat-In-Voice-Channels#h_01FMJT412WBX1MR4HDYNR8E95X">channel's text chat</a>.
For example, write <code>if &lt; 0 )</code> if you think those are the four that get evaluated.
A member of the course staff will review your answer and give feedback.
--></p>

<!-- <include topics/interpreters/print_evals.md> -->

<!-- # Document the Occasion

Please all fill out the <a href="https://docs.google.com/forms/d/e/1FAIpQLSeqlK8l6WkScGr-RHR-kM4p5bnR9cllYrG95fDqPJspSlll7A/viewform">attendance form</a> (one submission per person per week).

**Important:** Please help put the furniture in the room back where you found it before you leave. Thanks! -->
<script>
    $('.alwaystoggle').css('display', 'inline-block');
    $('.alwaystoggle').click(function() {
      var solution_id = $(this).attr('id');
      $('div.' + solution_id).slideToggle(600);
    });
</script>

  </div>

  <div class='col-md-3 sticky'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="index.html#tail-calls">Tail Calls</a></li>
  <ul>
    <li><a href="index.html#tail-call-optimization">Tail Call Optimization</a></li>
    <li><a href="index.html#tail-context">Tail Context</a></li>
    <ul>
      <li><a href="index.html#q1-fast-exp">Q1: Fast-Exp</a></li>
      <li><a href="index.html#q2-reverse">Q2: Reverse</a></li>
    </ul>
  </ul>
  <li><a href="index.html#scheme-data-abstraction">Scheme Data Abstraction</a></li>
  <ul>
    <li><a href="index.html#q3-distance">Q3: Distance</a></li>
    <li><a href="index.html#q4-closer-city">Q4: Closer City</a></li>
  </ul>
  <li><a href="index.html#submit-attendance">Submit Attendance</a></li>
</ul>
    </nav>
  </div>
</div>

    </main>

    <!-- <footer class="container">
      <div class="row text-center">
        <div class="col col-sm-4">
          <h3><a href="/">CS 61A</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/weekly">Weekly Schedule</a></li>
            <li><a href="/office-hours">Office Hours</a></li>
            <li><a href="/staff">Staff</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/resources">Resources</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/studying">Studying Guide</a></li>
            <li><a href="/articles/debugging">Debugging Guide</a></li>
            <li><a href="/articles/composition">Composition Guide</a></li>
            <li><a href="/articles/pair-programming">Pair Programming</a></li>
          </ul>
        </div>
        <div class="col col-sm-4">
          <h3><a href="/articles/about">Policies</a></h3>
          <ul class="nav nav-pills nav-stacked">
            <li><a href="/articles/about#assignments">Assignments</a></li>
            <li><a href="/articles/about#exams">Exams</a></li>
            <li><a href="/articles/about#grading">Grading</a></li>
          </ul>
        </div>
      </div>
    </footer> -->

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>
  <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">
  <script>
      require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
      window.MonacoEnvironment = { getWorkerUrl: () => URL.createObjectURL(new Blob([`
      self.MonacoEnvironment = {
          baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
      };
      importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
  `], { type: 'text/javascript' }))
  };
  </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.15.5/js/jsplumb.min.js"></script>
    <script src="../../assets/js/network_storage.js"></script>
    <script src="../../assets/js/storable.js"></script>
    <script src="../../assets/js/editor.js"></script>
    <script src="../../assets/js/copy-button.js"></script>
    <script src="../../assets/js/env-diagram.js"></script>
    
<!-- <script src="/assets/js/sketchy.js"></script> -->
<script>
  $('.sidebar ul').addClass('nav nav-stacked noselect');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });

  function goToId(id) {
    var target = $(id);
    target.parent().show();
    $('html,body').animate({
      scrollTop: target.offset().top,
    }, 100);
    $("body").scrollspy('refresh');
  }

  if (location.hash) {
    setTimeout(function() {
      if (location.hash) {
        goToId(location.hash);
      }
    }, 1);
  }

  $("a").click(function(event) {
    var urlBeforeHashRegEx = new RegExp("^"+window.location.href.split("#")[0]);
    if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
      event.preventDefault();
      goToId(this.hash);
      document.location.hash = this.hash;
    }
  });
</script>

  </body>
</html>